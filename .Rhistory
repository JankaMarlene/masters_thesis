print(results)
print(result)
##------ 8.3 rel and absolute delta frontal---------------
plot_rel_delta <- df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_delta_power, color = cluster_2))+
geom_boxplot(size = 0.75,outlier.colour = NA, width=0.5)+
geom_jitter(width = 0.2, height = 0, alpha = 0.6, size = 2)+
geom_signif(comparisons = list(c("c1","c2")),map_signif_level = TRUE, color = 'black')+
labs(y = 'mean delta power [μV^2] in frontal ROI', x = 'cluster')+
scale_color_manual(values = color_palette) +
theme_classic()+
guides(color = FALSE)+
theme(
text = element_text(size = 14)  # Adjust the size here
)
# Wilcoxon test
# in order to get the W statistics
wilcox.test(mean_delta_power~cluster_2, data = df_corr_frontal_filtered_group,
alternative = 'less',
exact = FALSE,
correct = FALSE,
conf.int = FALSE)
df_corr_frontal_filtered_group <-df_corr_frontal_filtered_group%>%
mutate(cluster_2 = as.factor(cluster_2))# otherwise wilcoxon_test from coin does not work
# in order to get the z value
result <- coin::wilcox_test(data = df_corr_frontal_filtered_group,mean_delta_power~cluster_2, comparisons = list(c('c1','c2')), alternative = 'less')
print(result)
# get the effsize
df_corr_frontal_filtered_group%>%
ungroup()%>%
wilcox_effsize(mean_delta_power~cluster_2)
#------ 9. plot behavioral data and corr test ------
## ------- 9.1 just behavioral data ---------------
# TMT A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_a_time))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# FACIT
df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = facit_f_FS, color = cluster_2))+
geom_boxplot(size = 0.75,outlier.colour = 'black', width=0.5)+
geom_jitter(width = 0.2, height = 0, alpha = 0.6, size = 2)+                                         # Add p-value to plot
geom_signif(comparisons = list(c("c1","c2")),map_signif_level = function(p) sprintf("p = %.2g", p),test = "t.test", color = 'black')+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]')+
scale_color_manual(values = color_palette) +
theme_classic()+
guides(color = FALSE)+
theme(
text = element_text(size = 15)  # Adjust the size here
)
# TMT B-A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_diff))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# moca
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = moca))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
wilcox.test(moca~cluster_2, data = df_corr_frontal_filtered,
exact = FALSE,
correct = FALSE,
conf.int = FALSE)
# FACIT and HADS-D
p8<- df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
ggplot(aes(x = hads_d_total_score,y = facit_f_FS, color = cluster_2))+
geom_point(size = 2)+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]',
x = 'HADS-D Score [Range: 0-21]')+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
scale_color_manual(values = color_palette) +
theme_classic() +
theme(legend.position = c(0.20, 0.15))+
stat_cor(aes(color = "Correlation: "),method = "spearman", label.x = 12, label.y = 40,hjust=0)
ggMarginal(p8, type = "densigram")
cor.test(df_corr_frontal_filtered_group$facit_f_FS,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
# TMT with FACIT
df_corr_frontal_filtered%>%
ggplot(aes(x = facit_f_FS, y = tmt_a_time))+
geom_point()
cor.test(df_corr_frontal_filtered$tmt_a_time,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
df_corr_frontal_filtered%>%
ggplot(aes(x = facit_f_FS, y = tmt_diff))+
geom_point()
cor.test(df_corr_frontal_filtered$tmt_diff,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
#moca
cor.test(df_corr_frontal_filtered$moca,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
# HADS with TMT-A/B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$tmt_diff,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$moca,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
# TMT-A with TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$moca, method = 'spearman', exact = FALSE)
# TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_diff,df_corr_frontal_filtered_group$moca, method = 'spearman', exact = FALSE)
# very high correlation
## --------- 9.2 corr tests ---------------------------
### ---- 9.2.1 relative delta power with TMT-A and TMT-B-A------------
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = mean_delta_power,y = tmt_a_time, color = cluster_2))+
geom_point()
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$tmt_a_time, method = 'spearman', exact = FALSE)
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = tmt_diff,y = mean_delta_power,color = cluster_2))+
geom_point()
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
# very high correlation
## --------- 9.2 corr tests ---------------------------
### ---- 9.2.1 relative delta power with TMT-A and TMT-B-A------------
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = mean_delta_power,y = tmt_b_time, color = cluster_2))+
geom_point()
View(table_power_central)
# TMT B
df_corr_frontal%>%
group_by(cluster_2)%>%
ggplot(aes(tmt_b_time))+
geom_histogram(color = "black",
fill = "white", bins = sqrt(100))+
facet_wrap(~cluster_2,scales = 'free')+
theme_classic()# looks okay
shapiro.test(shapiro_df_self-reportedCD$tmt_b_time)
shapiro.test(shapiro_df_no_self-reportedCDPCS$tmt_b_time)
leveneTest(tmt_b_time~cluster_2,data = df_corr_frontal)# not significant
t.test(tmt_b_time~cluster_2, data = df_corr_frontal, alternative = "two.sided", paired = FALSE)# p = 0.059
wilcox.test(tmt_b_time~cluster_2, data = df_corr_frontal,
exact = FALSE,
correct = FALSE,
conf.int = FALSE)# 0.038
#effsize
df_corr_frontal%>%
ungroup()%>%
wilcox_effsize(tmt_b_time~cluster_2)# moderate
# in order to get the z value
result <- coin::wilcox_test(data = df_corr_frontal,tmt_b_time~cluster_2, comparisons = list(c('c1','c2')), alternative = 'two.sided')
#effsize
df_corr_frontal%>%
ungroup()%>%
wilcox_effsize(tmt_b_time~cluster_2)# moderate
# in order to get the z value
result <- coin::wilcox_test(data = df_corr_frontal,tmt_b_time~cluster_2, comparisons = list(c('c1','c2')), alternative = 'two.sided')
# summarize values into one table
table_behav <- df_corr_frontal%>%
group_by(cluster_2)%>%
summarise(mean_facit = mean(facit_f_FS, na.rm = T),
sd_facit = sd(facit_f_FS, na.rm = T),
mean_hads = mean(hads_d_total_score, na.rm = T),
sd_hads = sd(hads_d_total_score, na.rm = T),
mean_tmta = mean(tmt_a_time),
sd_tmta = sd(tmt_a_time),
mean_tmtb = mean(tmt_b_time),
sd_tmtb = sd(tmt_b_time),
mean_tmtb_a = mean(tmt_diff),
sd_tmtb_a = sd(tmt_diff),
mean_y_o = mean(years_of_education),
sd_y_o = sd(years_of_education),
mean_epoc = mean(number_epochs),
sd_epoc = sd(number_epochs),
mean_moca = mean(moca, na.rm = T),
sd_moca = sd(moca, na.rm = T))
#------ 5. exclude outliers--------
##-------- 5.1 delta ---------------
# relative delta power frontal
df_corr_frontal%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_delta_power, color = cluster_2))+
geom_boxplot()# two outliers in the c2 cluster_2
# outlier removal inside the participant with +/- 3SD
table_delta_filtered <-table_power_5%>%
group_by(participant_id) %>%
mutate(mean_rel_delta = mean(rel_delta),
sd_rel_delta = sd(rel_delta),
lower_bound = mean_rel_delta - 3 * sd_rel_delta,
upper_bound = mean_rel_delta + 3 * sd_rel_delta) %>%
filter(rel_delta >= lower_bound & rel_delta <= upper_bound) %>%
ungroup()
# last step: remove negative values
table_delta_filtered$rel_delta <- ifelse(
table_delta_filtered$rel_delta < 0, 0, table_delta_filtered$rel_delta)
# visualize the filtered data
table_delta_filtered%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = rel_delta, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()
# select only frontal channels
table_delta_frontal_filtered <- table_delta_filtered%>%
filter(table_delta_filtered$channel %in% frontal_channels)
df_corr_frontal_filtered <- table_delta_frontal_filtered%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age,years_of_education,moca)%>%
summarise(mean_delta_power = mean(rel_delta))
df_corr_frontal_filtered%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_delta_power, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()# 4 outliers in c2
table_frontal_filtered_group <- table_delta_filtered_group%>%
filter(table_delta_filtered_group$channel %in% frontal_channels)
df_corr_frontal_filtered_group <- table_frontal_filtered_group%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age,moca,hads_d_total_score)%>%
summarise(mean_delta_power = mean(rel_delta),
mean_delta_power = mean(rel_delta),
mean_aperiodic_exponent = mean(aperiodic_exponent))
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_delta_power, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()# 2 outliers in c2 and 1 in c1
# outliers delta absolute
table_delta_filtered_abs <-table_power_5%>%
group_by(participant_id) %>%
mutate(mean_abs_delta = mean(abs_delta),
sd_abs_delta = sd(abs_delta),
lower_bound = mean_abs_delta - 3 * sd_abs_delta,
upper_bound = mean_abs_delta + 3 * sd_abs_delta) %>%
filter(abs_delta >= lower_bound & abs_delta <= upper_bound) %>%
ungroup()
table_delta_frontal_filtered_abs <- table_delta_filtered_abs%>%
filter(table_delta_filtered_abs$channel %in% frontal_channels)
df_corr_frontal_filtered_abs <- table_delta_frontal_filtered_abs%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age,years_of_education)%>%
summarise(mean_delta_power_abs = mean(abs_delta))
df_corr_frontal_filtered_abs%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_delta_power_abs, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()
kruskal.test(mean_delta_power_abs~cluster_2, data = df_corr_frontal_filtered_abs)
## ----------- 5.2 relative beta power central ----------------------------
df_corr_central%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_beta_power, color = cluster_2))+
geom_boxplot()# one outlier in c2, one in the c1 cluster_2
# sd +- 3 for beta
table_beta_filtered <-table_power_5%>%
group_by(participant_id) %>%
mutate(mean_rel_beta = mean(rel_beta),
sd_rel_beta = sd(rel_beta),
lower_bound = mean_rel_beta - 3 * sd_rel_beta,
upper_bound = mean_rel_beta + 3 * sd_rel_beta) %>%
filter(rel_beta >= lower_bound & rel_beta <= upper_bound) %>%
ungroup()
table_central_filtered <- table_beta_filtered%>%
filter(table_beta_filtered$channel %in% central_channels)
df_corr_central_filtered <- table_central_filtered%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age, moca,hads_d_total_score)%>%
summarise(mean_beta_power = mean(rel_beta))
df_corr_central_filtered%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_beta_power, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()# one outlier in c2 cluster_2 and one in c1 cluster_2
# additional filtering (across cluster_2)
table_beta_filtered_group <- table_beta_filtered%>%
group_by(cluster_2)%>%
mutate(mean_rel_beta = mean(rel_beta),
sd_rel_beta = sd(rel_beta),
lower_bound = mean_rel_beta - 3 * sd_rel_beta,
upper_bound = mean_rel_beta + 3 * sd_rel_beta) %>%
filter(rel_beta >= lower_bound & rel_beta <= upper_bound) %>%
ungroup()
table_central_filtered_group <- table_beta_filtered_group%>%
filter(table_beta_filtered_group$channel %in% central_channels)
df_corr_central_filtered_group <- table_central_filtered_group%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age, moca, hads_d_total_score)%>%
summarise(mean_beta_power = mean(rel_beta))
df_corr_central_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_beta_power, color = cluster_2))+
geom_boxplot(outlier.colour = 'black')+
geom_jitter()# 1 outlier in c2 and 2 in c1
## ----------- 5.3 aperiodic components -------------------------------------------
# +- 3 sd for aperiodic exponent
table_ape_filtered <-table_power_5%>%
group_by(participant_id) %>%
mutate(mean_ape = mean(aperiodic_exponent),
sd_ape = sd(aperiodic_exponent),
lower_bound = mean_ape - 3 * sd_ape,
upper_bound = mean_ape + 3 * sd_ape) %>%
filter(aperiodic_exponent >= lower_bound & aperiodic_exponent <= upper_bound) %>%
ungroup()
df_corr_ape <- table_ape_filtered%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age,moca,hads_d_total_score)%>%
summarise(mean_aperiodic_exponent = mean(aperiodic_exponent))
df_corr_ape%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_aperiodic_exponent, color = cluster_2))+
geom_boxplot()+
geom_jitter()
# +- 3 SD for aperiodic offset
table_apo_filtered <-table_power_5%>%
group_by(participant_id) %>%
mutate(mean_apo = mean(aperiodic_offset),
sd_apo = sd(aperiodic_offset),
lower_bound = mean_apo - 3 * sd_apo,
upper_bound = mean_apo + 3 * sd_apo) %>%
filter(aperiodic_offset >= lower_bound & aperiodic_offset <= upper_bound) %>%
ungroup()
df_corr_apo <- table_apo_filtered%>%
group_by(participant_id,cluster_2,tmt_a_time, tmt_b_time, facit_f_FS, tmt_diff,age,moca,hads_d_total_score)%>%
summarise(mean_aperiodic_offset = mean(aperiodic_offset))
df_corr_apo%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = mean_aperiodic_offset, color = cluster_2))+
geom_boxplot()+
geom_jitter()
#------ 9. plot behavioral data and corr test ------
## ------- 9.1 just behavioral data ---------------
# TMT A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_a_time))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# FACIT
df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
group_by(cluster_2)%>%
ggplot(aes(x = cluster_2, y = facit_f_FS, color = cluster_2))+
geom_boxplot(size = 0.75,outlier.colour = 'black', width=0.5)+
geom_jitter(width = 0.2, height = 0, alpha = 0.6, size = 2)+                                         # Add p-value to plot
geom_signif(comparisons = list(c("c1","c2")),map_signif_level = function(p) sprintf("p = %.2g", p),test = "t.test", color = 'black')+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]')+
scale_color_manual(values = color_palette) +
theme_classic()+
guides(color = FALSE)+
theme(
text = element_text(size = 15)  # Adjust the size here
)
# TMT B-A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_diff))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# moca
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = moca))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
wilcox.test(moca~cluster_2, data = df_corr_frontal_filtered,
exact = FALSE,
correct = FALSE,
conf.int = FALSE)
# TMT A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_b_time))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# TMT B-A
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = tmt_diff))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
# moca
df_corr_frontal_filtered%>%
ggplot(aes(x = cluster_2, y = moca))+
geom_boxplot()+
geom_jitter(width = 0.3, height = 0, alpha = 0.1)
wilcox.test(moca~cluster_2, data = df_corr_frontal_filtered,
exact = FALSE,
correct = FALSE,
conf.int = FALSE)
# FACIT and HADS-D
p8<- df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
ggplot(aes(x = hads_d_total_score,y = facit_f_FS, color = cluster_2))+
geom_point(size = 2)+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]',
x = 'HADS-D Score [Range: 0-21]')+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
scale_color_manual(values = color_palette) +
theme_classic() +
theme(legend.position = c(0.20, 0.15))+
stat_cor(aes(color = "Correlation: "),method = "spearman", label.x = 12, label.y = 40,hjust=0)
ggMarginal(p8, type = "densigram")
cor.test(df_corr_frontal_filtered_group$facit_f_FS,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
# TMT with FACIT
df_corr_frontal_filtered%>%
ggplot(aes(x = facit_f_FS, y = tmt_a_time))+
geom_point()
cor.test(df_corr_frontal_filtered$tmt_a_time,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
df_corr_frontal_filtered%>%
ggplot(aes(x = facit_f_FS, y = tmt_diff))+
geom_point()
cor.test(df_corr_frontal_filtered$tmt_diff,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered$tmt_b_time,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
#moca
cor.test(df_corr_frontal_filtered$moca,df_corr_frontal_filtered$facit_f_FS, method = 'spearman', exact = FALSE)
# HADS with TMT-A/B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
# HADS with TMT-A/B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_b_time,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$tmt_diff,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$moca,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
# TMT-A with TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
# TMT-A with TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_b_time,df_corr_frontal_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
# TMT-A with TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$tmt_b_time, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$tmt_a_time,df_corr_frontal_filtered_group$moca, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$tmt_b_time,df_corr_frontal_filtered_group$moca, method = 'spearman', exact = FALSE)
# TMT B-A and MoCA
cor.test(df_corr_frontal_filtered_group$tmt_diff,df_corr_frontal_filtered_group$moca, method = 'spearman', exact = FALSE)
-----
# very high correlation
## --------- 9.2 corr tests ---------------------------
### ---- 9.2.1 relative delta power with TMT-A and TMT-B-A------------
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = mean_delta_power,y = tmt_a_time, color = cluster_2))+
geom_point()
# very high correlation
## --------- 9.2 corr tests ---------------------------
### ---- 9.2.1 relative delta power with TMT-A and TMT-B-A------------
df_corr_frontal_filtered_group%>%
group_by(cluster_2)%>%
ggplot(aes(x = mean_delta_power,y = tmt_a_time, color = cluster_2))+
geom_point()
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$tmt_a_time, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$tmt_b_time, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
cor.test(df_corr_frontal_filtered$mean_delta_power,df_corr_frontal_filtered$moca, method = 'spearman', exact = FALSE)
###-------- 9.2.3 relative and absolute delta and FACIT score ------------------------
p1<- df_corr_frontal_filtered_group%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
ggplot(aes(x = mean_delta_power,y = facit_f_FS, color = cluster_2))+
geom_point(size = 2.5)+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]',
x = 'mean delta power [μV^2]')+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
scale_color_manual(values = color_palette) +
theme_classic() +
theme(legend.position = c(0.14, 0.15))+
stat_cor(aes(color = "Correlation: "),method = "spearman", label.x = 2, label.y = 41,hjust=0)+
theme(
text = element_text(size = 15)  # Adjust the size here
)
# one NA
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$facit_f_FS, method = 'spearman', exact = FALSE)
# just curious = > divide into the two groups and test separately
p5<- df_corr_frontal_filtered_group%>%
filter(cluster_2 == 'c1')%>%
ggplot(aes(x = mean_delta_power,y = facit_f_FS))+
geom_point()+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
theme_classic() +
theme(legend.position = c(0.25, 0.15))
test <- df_corr_frontal_filtered_group%>%
filter(cluster_2 == 'c1')
cor.test(test$mean_delta_power,test$facit_f_FS) #
p6 <- df_corr_frontal_filtered_group%>%
filter(cluster_2 == 'c2')%>%
ggplot(aes(x = mean_delta_power,y = facit_f_FS))+
geom_point()+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
theme_classic() +
theme(legend.position = c(0.25, 0.15))
test2 <- df_corr_frontal_filtered_group%>%
filter(cluster_2 == 'c2')
cor.test(test2$mean_delta_power,test2$facit_f_FS)
# absolute delta power
p1<- df_corr_frontal_filtered_abs%>%
mutate(cluster_2 = fct_recode(cluster_2,
"c1" = "c1",
"c2" = "c2"))%>%
ggplot(aes(x = mean_delta_power_abs,y = facit_f_FS, color = cluster_2))+
geom_point(size = 2.5)+
labs(y = 'FACIT Fatigue Scale [Range: 0-52]',
x = 'mean delta power [μV^2]')+
geom_smooth(method=lm , color="black", fill="grey", se=TRUE) +
scale_color_manual(values = color_palette) +
theme_classic() +
theme(legend.position = c(0.14, 0.15))+
stat_cor(aes(color = "Correlation: "),method = "spearman", label.x = 2, label.y = 41,hjust=0)+
theme(
text = element_text(size = 15)  # Adjust the size here
)
cor.test(df_corr_frontal_filtered_group$mean_delta_power,df_corr_frontal_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$tmt_a_time, method = 'spearman', exact = FALSE)
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$tmt_b_time, method = 'spearman', exact = FALSE)
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$tmt_diff, method = 'spearman', exact = FALSE)
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$facit_f_FS, method = 'spearman', exact = FALSE)
#hads
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$hads_d_total_score, method = 'spearman', exact = FALSE)
#moca
cor.test(df_corr_central_filtered_group$mean_beta_power,df_corr_central_filtered_group$moca, method = 'spearman', exact = FALSE)
# beta and delta
corr_power <- cbind(df_corr_central_filtered_group,df_corr_frontal_filtered_group)
cor.test(corr_power$mean_beta_power,corr_power$mean_delta_power, method = 'spearman', exact = FALSE)
